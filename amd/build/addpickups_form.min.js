/**
 * JavaScript for deleting pickups in the add pickups form.
 *
 * @module      local_equipment/addpickups_form
 * @copyright   2024 onward Joshua Kirby <josh@funlearningcompany.com>
 * @author      Joshua Kirby - CTO @ Fun Learning Company - funlearningcompany.com
 * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
M.util.js_pending("local_equipment/addpickups_form"),define("local_equipment/addpickups_form",["jquery","core/log","core/str"],(($,log,Str)=>({init:()=>{$(document).ready((function(){const selector="fieldset[id^='id_pickupheader_']";log.debug("Add Pickup Form JS initialized");const updateTrashIcons=()=>{log.debug("updateTrashIcons");const pickups=$(selector);log.debug("pickups"),log.debug(pickups),log.debug('$(".local-equipment-remove-pickup")'),log.debug($(".local-equipment-remove-pickup")),pickups.length>1?(log.debug("if"),$(".local-equipment-remove-pickup").show()):(log.debug("else"),$(".local-equipment-remove-pickup").hide())};$(document).on("click",".local-equipment-remove-pickup",(function(){log.debug("Event triggered");const $fieldset=$(this).closest(selector);log.debug($fieldset);const removedfieldset=$fieldset.remove();log.debug("Fieldset removed"),log.debug("Here's what returned from the '$fieldset.remove()' command:"),log.debug(removedfieldset),log.debug("updatePickupNumbers"),$(".local-equipment-pickup-header").each(((index,element)=>{Str.get_string("pickup","local_equipment",index+1).then((string=>{$(element).text(string)})).catch((error=>{log.error("Error updating pickup header:",error)}))})),(()=>{log.debug("updateHiddenFields");const pickupsCount=$(selector).length;log.debug("Number of fieldsets: ".concat(pickupsCount)),$('input[name="pickups"]').val(pickupsCount);const url=new URL(window.location.href);url.searchParams.set("repeatno",pickupsCount),window.history.replaceState({},"",url)})(),log.debug("renumberFormElements"),$(selector).each(((index,fieldset)=>{log.debug("Renumbering fieldset ".concat(index)),$(fieldset).find("input, select, textarea").each(((_,element)=>{const name=$(element).attr("name");if(name){const newName=name.replace(/\[\d+\]/,"[".concat(index,"]"));$(element).attr("name",newName)}const id=$(element).attr("id");if(id){const newId=id.replace(/_\d+_/,"_".concat(index,"_"));$(element).attr("id",newId)}}))})),updateTrashIcons()})),updateTrashIcons()})),M.util.js_complete("local_equipment/addpickups_form")}})));

//# sourceMappingURL=addpickups_form.min.js.map