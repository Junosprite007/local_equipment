/**
 * JavaScript for deleting partnerships in the add partnerships form.
 *
 * @module      local_equipment/addpartnership_form
 * @copyright   2024 onward Joshua Kirby <josh@funlearningcompany.com>
 * @author      Joshua Kirby - CTO @ Fun Learning Company - funlearningcompany.com
 * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
*/
define("local_equipment/addpartnership_form",["jquery","core/log","core/str"],(($,log,Str)=>({init:()=>{$(document).ready((function(){log.debug("Add Partnership Form JS initialized");const updatePartnershipNumbers=()=>{$(".local-equipment-partnership-header").each(((index,element)=>{Str.get_string("partnership","local_equipment",index+1).then((string=>{$(element).text(string)})).catch((error=>{log.error("Error updating partnership header:",error)}))}))},updateHiddenFields=()=>{log.debug("updateHiddenFields");const partnershipsCount=$("fieldset").length;$('input[name="partnerships"]').val(partnershipsCount);const url=new URL(window.location.href);url.searchParams.set("repeatno",partnershipsCount),window.history.replaceState({},"",url)},updateTrashIcons=()=>{log.debug("updateTrashIcons");$("fieldset").length>1?$(".local-equipment-remove-partnership").show():$(".local-equipment-remove-partnership").hide()};updatePartnershipNumbers(),updateHiddenFields(),updateTrashIcons(),$(document).on("click",".local-equipment-remove-partnership",(function(){log.debug("Event triggered");const $fieldset=$(this).closest("fieldset");log.debug($fieldset),log.debug($fieldset.is(":first-of-type")),$fieldset.remove(),log.debug($fieldset),updatePartnershipNumbers(),updateHiddenFields(),log.debug("renumberFormElements"),$("fieldset").each(((index,fieldset)=>{log.debug(fieldset),$(fieldset).find("input, select, textarea").each(((_,element)=>{const name=$(element).attr("name");if(name){const newName=name.replace(/\[\d+\]/,"[".concat(index,"]"));$(element).attr("name",newName)}const id=$(element).attr("id");if(id){const newId=id.replace(/_\d+_/,"_".concat(index,"_"));$(element).attr("id",newId)}}))})),updateTrashIcons()}))}))}})));

//# sourceMappingURL=addpartnership_form.min.js.map