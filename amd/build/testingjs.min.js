define("local_equipment/testingjs",["exports","jquery","core/log","core/str"],(function(_exports,_jquery,_log,Str){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * JavaScript for deleting partnerships in the add partnerships form.
   *
   * @module      local_equipment/addpartnership_form
   * @copyright   2024 onward Joshua Kirby <josh@funlearningcompany.com>
   * @author      Joshua Kirby - CTO @ Fun Learning Company - funlearningcompany.com
   * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_log=_interopRequireDefault(_log),Str=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Str);_exports.init=()=>{(0,_jquery.default)((function(){_log.default.debug("Add Partnership Form JS initialized");const updateTrashIcons=()=>{_log.default.debug("updateTrashIcons");const partnerships=(0,_jquery.default)("fieldset");_log.default.debug("partnerships: "),_log.default.debug(partnerships),partnerships.length>1?(_log.default.debug("show"),(0,_jquery.default)(".local-equipment-remove-partnership").show()):(_log.default.debug("hide"),(0,_jquery.default)(".local-equipment-remove-partnership").hide())};updateTrashIcons(),(0,_jquery.default)(document).on("click",".local-equipment-remove-partnership",(function(){_log.default.debug("Event triggered");const $fieldset=(0,_jquery.default)(this).closest("fieldset");_log.default.debug($fieldset);const removedfieldset=$fieldset.remove();_log.default.debug("Fieldset removed"),_log.default.debug("Here's what returned from the '$fieldset.remove()' command:"),_log.default.debug(removedfieldset),(0,_jquery.default)(".local-equipment-partnership-header").each(((index,element)=>{Str.get_string("partnership","local_equipment",index+1).then((string=>{(0,_jquery.default)(element).text(string)})).catch((error=>{_log.default.error("Error updating partnership header:",error)}))})),(()=>{_log.default.debug("updateHiddenFields");const partnershipsCount=(0,_jquery.default)("fieldset").length;_log.default.debug("Number of partnerships: ".concat(partnershipsCount)),(0,_jquery.default)('input[name="partnerships"]').val(partnershipsCount);const url=new URL(window.location.href);url.searchParams.set("repeatno",partnershipsCount),window.history.replaceState({},"",url)})(),_log.default.debug("renumberFormElements"),(0,_jquery.default)("fieldset").each(((index,fieldset)=>{_log.default.debug("Renumbering fieldset ".concat(index)),(0,_jquery.default)(fieldset).find("input, select, textarea").each(((_,element)=>{const name=(0,_jquery.default)(element).attr("name");if(name){const newName=name.replace(/\[\d+\]/,"[".concat(index,"]"));(0,_jquery.default)(element).attr("name",newName)}const id=(0,_jquery.default)(element).attr("id");if(id){const newId=id.replace(/_\d+_/,"_".concat(index,"_"));(0,_jquery.default)(element).attr("id",newId)}}))})),updateTrashIcons()}))}))}}));

//# sourceMappingURL=testingjs.min.js.map