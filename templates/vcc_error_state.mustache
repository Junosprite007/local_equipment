{{!
    @template local_equipment/vcc_error_state

    VCC submissions table error state template.

    Used when an error occurs while loading or processing VCC submissions data.
    Provides user-friendly error messages with retry options.

    Context variables:
    * error_type - The type of error (e.g., 'network', 'server', 'validation')
    * error_message - The error message to display
    * show_retry - Boolean indicating if retry button should be shown
    * retry_url - URL for retry action (optional)
    * support_email - Support email for help (optional)
    * technical_details - Technical error details for debugging (optional, only shown to admins)
    * is_admin - Boolean indicating if current user has admin privileges
}}
<div class="alert alert-danger" role="alert">
    <div class="d-flex align-items-center mb-3">
        <i class="fa fa-exclamation-triangle fa-2x me-3 text-danger" aria-hidden="true"></i>
        <div class="flex-grow-1">
            <h4 class="alert-heading mb-2">
                {{#str}}errorloadingdata, local_equipment{{/str}}
            </h4>
            <p class="mb-0">
                {{#error_message}}
                    {{{error_message}}}
                {{/error_message}}
                {{^error_message}}
                    {{#str}}unexpectederror, local_equipment{{/str}}
                {{/error_message}}
            </p>
        </div>
    </div>

    {{#show_retry}}
    <div class="d-flex flex-wrap align-items-center gap-2">
        {{#retry_url}}
        <a href="{{{retry_url}}}" class="btn btn-outline-danger">
            <i class="fa fa-refresh me-1" aria-hidden="true"></i>
            {{#str}}pleasetryagain, local_equipment{{/str}}
        </a>
        {{/retry_url}}
        {{^retry_url}}
        <button type="button" class="btn btn-outline-danger" onclick="location.reload()">
            <i class="fa fa-refresh me-1" aria-hidden="true"></i>
            {{#str}}pleasetryagain, local_equipment{{/str}}
        </button>
        {{/retry_url}}

        {{#support_email}}
        <a href="mailto:{{{support_email}}}" class="btn btn-outline-secondary">
            <i class="fa fa-envelope me-1" aria-hidden="true"></i>
            {{#str}}help, core{{/str}}
        </a>
        {{/support_email}}
    </div>
    {{/show_retry}}

    {{#is_admin}}
    {{#technical_details}}
    <details class="mt-3">
        <summary class="text-muted">
            <small>{{#str}}details, local_equipment{{/str}}</small>
        </summary>
        <pre class="mt-2 p-2 bg-light text-muted small border rounded"><code>{{{technical_details}}}</code></pre>
    </details>
    {{/technical_details}}
    {{/is_admin}}

    <div class="mt-3">
        <small class="text-muted">
            {{#str}}time, core{{/str}}: {{timestamp}}
        </small>
    </div>
</div>

{{! Screen reader friendly error announcement }}
<div class="visually-hidden" aria-live="polite" role="status">
    {{#str}}errorloadingdata, local_equipment{{/str}}: {{error_message}}
</div>
